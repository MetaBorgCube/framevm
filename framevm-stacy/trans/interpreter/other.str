module other

imports 
	signatures/framevm-stacy-sig
	interpreter/external
	
	stc-common

rules	// Other instructions

	// STC_Print/0
	// Print the value on top of the stack to the console
	eval: (STC_Print(), env1) -> env3
	  where
	  	(env2, val) := <stack-pop-any(|env1)>;
	  	(env3, out) := <vm-print(|env2)> <val-to-string> val;
	  	_ := <debug> out
	  	
	// STC_Debug/0
	// Print the state of the vm to the console
	eval: (STC_Debug(), env1) -> env2
	  where
	  	env2 := <vm-debug(|env1)>
	  	
	// STC_DebugKill/0
	// Print the state of the vm to the console and terminate
	eval: (STC_DebugKill(), env1) -> <fail> env2
	  where
	  	env2 := <vm-debug(|env1)>
	
	
rules	// Util
	// Convert a value to a displayable string 
	val-to-string: IntV(v) -> v
	val-to-string: FrameRef(frame) -> frame
	val-to-string: Continuation(cont) -> cont
	
	
