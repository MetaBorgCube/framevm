module type

imports 
	signatures/framevm-sig
	interpreter/common
	interpreter/external

rules
	// FVM_IsInt/0
	// Checks if the element on top of the stack is an integer
	eval: (FVM_IsInt(), env1) -> env3
	  where
	  	(env2, val) := <stack-pop-any(|env1)>;
	  	env3 := <stack-push(|env2)> <is-intV> val
	
	is-intV: IntV(_) -> IntV("1")
	is-intV: _       -> IntV("0")
	
	// FVM_IsFrame/0
	// Checks if the element on top of the stack is a Frame
	eval: (FVM_IsFrame(), env1) -> env3
	  where
	  	(env2, val) := <stack-pop-any(|env1)>;
	  	env3 := <stack-push(|env2)> <is-frame> val
	
	is-frame: FrameRef(_) -> IntV("1")
	is-frame: _           -> IntV("0")
	
	// FVM_IsCont/0
	// Checks if the element on top of the stack is a Continuation
	eval: (FVM_IsCont(), env1) -> env3
	  where
	  	(env2, val) := <stack-pop-any(|env1)>;
	  	env3 := <stack-push(|env2)> <is-cont> val
	
	is-cont: Continuation(_) -> IntV("1")
	is-cont: _               -> IntV("0")
	
	